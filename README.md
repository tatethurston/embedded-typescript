# Embedded TypeScript

<blockquote>Type safe embedded TypeScript templates</blockquote>

## What is this? üßê

A templating system to generate type safe templates for TypeScript. Templates are compiled to TypeScript files, which can then be imported for type safe string generation.

This templating system draws inspiration from ERB, [EJS](https://ejs.co/), [handlebars](https://handlebarsjs.com/) and [mustache](https://github.com/janl/mustache.js). Specifically, this project embraces the "just JavaScript" semantics of ejs with some of the helpful white space semantics of mustache.

## Motivation

`Hello undefined!`

When using a typed language, I want my templates to be type checked. For most cases, [template literals](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals) perform the job nicely. If I'm writing XML, [JSX](https://www.typescriptlang.org/docs/handbook/jsx.html) works nicely. When I have complicated non-XML templates, template literals become difficult to maintain. I can use ejs/hbs/mustache/etc, but then I lose the type safety I had with template literals. Sometimes I want the expressiveness of a templating language, but I'm not willing to lose type safety.

## Notable deviations from prior art

Top level `<% CODE %>` blocks must be defined around any text. This enables complete control over the namespace: you explicitly specify exports and their type signature . This also enables using `import` to pull in any helpers, utilities or partials.

This templating system does _not_ perform any HTML escaping. You can `import` any self authored or 3rd party HTML escaping utilities in your template, and call that directly on any untrusted input.

## Syntax

`<%= EXPRESSION %>` ‚Äî Inserts the value of an expression.
`<% CODE %>` ‚Äî Executes code, but does not insert a value. Trims the preceding indentation and the following line break if placed on it's own line.

## Examples üöÄ

1. Write a template file: `my-template.ets`:

```
<% type User = { name: string; } %>

<% export function render(users: User[]): string { %>
  <% users.forEach(function(user) { %>
Name: <%= user.name %>
  <% }) %>
<% } %>
```

2. Run the compiler: `yarn ets`. This will compile any files with the `.ets` extension. `my-template.ets.ts` will be generated.

3. Import from the generated `.ets.ts` file:

```
import { render } from "./template-1.ets";

// will output:
// Name: Alice
// Name: Bob
console.log(render([
  { name: "Alice" },
  { name: "Bob" },
]))
```

Note that the arguments to your template function are typechecked. There isn't anything special about the `render` export, in our template file this could have been named anything: `printUserNames`.

For more examples, take a look at the `*.ets` template files in the project's [templates directory](https://github.com/tatethurston/embedded-typescript/blob/main/src/templates). The `*.ets.ts` files are generated by the compiler from the `*.ets` template files. The corresponding `*${NAME}.test.ts` shows example usage and output.

## Installation & Usage üì¶

1. Add this package to your project:
   - `yarn add embedded-typescript`

## Highlights

üéÅ Zero run time dependencies

## Contributing üë´

PR's and issues welcomed! For more guidance check out [CONTRIBUTING.md](https://github.com/tatethurston/embedded-typescript/blob/master/CONTRIBUTING.md)

## Licensing üìÉ

See the project's [MIT License](https://github.com/tatethurston/embedded-typescript/blob/master/LICENSE).
